set testdir [file dirname $argv0]
source $testdir/tester.tcl
set testprefix schema

proc setup_procedure {} {
  global database_name
  execsql {
    DROP TABLE IF EXISTS user_data
  }
  execsql {
    CREATE TABLE user_data(
      id_interger PRIMARY KEY,
      name_text NOT NULL UNIQUE,
      age_interger NOT NULL
    );
  }
  execsql {
    BEGIN TRANSACTION
  }
  execsql {
    INSERT INTO user_data(id_interger, name_text, age_interger)
    VALUES
    (1, 'John', 25);
  }
  execsql {
    INSERT INTO user_data(id_interger, name_text, age_interger)
    VALUES
    (2, 'Alice', 30);
  }
  execsql {
    INSERT INTO user_data(id_interger, name_text, age_interger)
    VALUES
    (3, 'Jack', 20);
  }
  execsql {
    COMMIT TRANSACTION
  }
}

do_execsql_test schema-1.1 {
  SELECT * FROM user_data WHERE id_interger = 1;
} {1 John 25}
do_execsql_test schema-1.2 {
  SELECT * FROM user_data WHERE name_text = 'Alice';
} {2 Alice 30}
do_execsql_test schema-1.3 {
  SELECT * FROM user_data;
} {1 John 25 2 Alice 30 3 Jack 20}
do_execsql_test schema-1.4 {
  CREATE TABLE IF_NOT_EXISTS(
    id_interger PRIMARY KEY,
    name_text NOT NULL UNIQUE,
    age_interger NOT NULL
  );
} {}
do_execsql_test schema-1.5 {
  SELECT * FROM user_data;
} {1 John 25 2 Alice 30 3 Jack 20}
do_execsql_test schema-1.6 {
  SELECT * FROM user_data WHERE age_interger = 20;
} {3 Jack 20}
do_execsql_test schema-1.7 {
  SELECT COUNT(*) FROM user_data WHERE name_text = 'Jack';
} {1}
do_execsql_test schema-1.8 {
  SELECT * FROM user_data WHERE name_text = 'John';
} {1 John 25}
do_execsql_test schema-1.9 {
  SELECT * FROM user_data WHERE age_interger = 30;
} {2 Alice 30}
do_execsql_test schema-1.10 {
  SELECT * FROM user_data WHERE age_interger = 25;
} {1 John 25}

setup_procedure
finish_test