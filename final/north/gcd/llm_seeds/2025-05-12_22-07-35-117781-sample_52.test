set testdir [file dirname $argv0]
source $testdir/tester.tcl
set testprefix main

proc test_func {op1 op2} {
  expr {$op1 $op2}
}

do_test 1.1 {
  set test_var 5
  incr test_var
  set test_var
} {6}

do_execsql_test 1.2 {
  DROP TABLE IF EXISTS a
} {}

set db_name "main.db"
execsql {
  ATTACH $db_name AS db2
  CREATE TABLE a AS SELECT 1
} "main"

do_execsql_test 1.3 {
  CREATE TABLE a AS SELECT 1
}
{
  1 0
}

do_execsql_test 1.4 {
  SELECT 1
}
{1}

do_execsql_test 1.5 {
  PRAGMA wal_checkpoint
}

do_execsql_test 1.6 {
  COPY a TO 'output.txt'
  SELECT name FROM pragma_database_list
}
{main}

do_execsql_test 1.7 {
  CREATE INDEX idx ON a(ROWID);
} {}

do_execsql_test 1.8 {
  SELECT name FROM sqlite_master UNION SELECT 1
}
{idx main sqlite_master 1}

if {0} {
  set sqlite_stdalloc 1
  proc sqlite3_stdalloc {nDb sz n} {}
  global sqlite_standard_test_count
} {execsql {
    PRAGMA incremental_vacuum;
  }
  do_execsql_test 1.9 {
    DELETE FROM a
  }
}

finish_test