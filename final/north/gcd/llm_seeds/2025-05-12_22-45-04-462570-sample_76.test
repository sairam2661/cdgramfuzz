set testdir [file dirname $argv0]
source $testdir/tester.tcl
set testprefix sqlite_fuzz
set testprefix query

proc sqlite_fuzz_proc {a b} {
  set c 0
  foreach x $a {
    incr c $x
  }
  expr {$c}
}

proc query_fuzz_proc {} {
  global queryargs
  set queryargs {}
  set x $::testdir
  lappend queryargs $x
  expr {1}
}

set queryargs {}

do_test query-1.1 {
  execsql {
    CREATE TABLE a(x);
    CREATE TABLE b(y);
    BEGIN;
    INSERT INTO a VALUES(1);
    INSERT INTO b VALUES(2);
    COMMIT;
  }
  set x $::testdir
  sqlite_fuzz_proc $x $queryargs
} {1}

do_execsql_test query-1.2 {
  PRAGMA journal_mode;
} {WAL}
do_execsql_test query-1.3 {
  PRAGMA synchronous;
} {Full}

ifcapable lock_proxy {
  set lockproxy 1
} else {
  set lockproxy 0
}

finish_test